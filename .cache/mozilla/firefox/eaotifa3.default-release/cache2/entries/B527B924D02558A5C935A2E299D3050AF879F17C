define("discourse/plugins/poll/lib/chart-colors",["exports"],function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getColors=function(t,e){var l;switch(e=e||"cool"){case"cool":l={0:[255,255,255],25:[220,237,200],50:[66,179,213],75:[26,39,62],100:[0,0,0]};break;case"warm":l={0:[255,255,255],25:[254,235,101],50:[228,82,27],75:[77,52,47],100:[0,0,0]}}for(var o,n,i=Object.keys(l),r=[],s=0;s<t;s++){o=(s+1)*(100/(t+1));for(var a=void 0,u=n=n||0;u<i.length;u++){if(!i[u+1]){a=u-1;break}if(o>=i[u]&&o<i[u+1]){a=u;break}}for(var p=(o-i[a])/(i[a+1]-i[a]),c=[],d=0;d<3;d++)c.push(Math.round(l[i[a]][d]-(l[i[a]][d]-l[i[a+1]][d])*p));r.push("rgb(".concat(c.toString(),")")),n=a}return r}}),define("discourse/plugins/poll/lib/even-round",["exports"],function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(t){for(var e=t.map(function(t){return t%1}),l=Math.ceil(e.reduce(function(t,e){return t+e})),o=0,n=e.length;o<l&&o<n;o++){for(var i=0,r=0,s=0;s<e.length;s++)e[s]>i&&(i=e[r=s]);if(++t[r],e[r]=0,100===t.map(function(t){return Math.floor(t)}).reduce(function(t,e){return t+e}))break}return t.map(function(t){return Math.floor(t)})}}),define("discourse/plugins/poll/lib/discourse-markdown/poll",["exports","I18n"],function(t,b){"use strict";function g(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var l=Object.prototype.toString.call(t).slice(8,-1);"Object"===l&&t.constructor&&(l=t.constructor.name);if("Map"===l||"Set"===l)return Array.from(t);if("Arguments"===l||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var l=0,o=new Array(e);l<e;l++)o[l]=t[l];return o}Object.defineProperty(t,"__esModule",{value:!0}),t.setup=function(t){t.allowList(["div.poll","div.poll-info","div.poll-container","div.poll-title","div.poll-buttons","div[data-*]","span.info-number","span.info-text","span.info-label","a.button.cast-votes","a.button.toggle-results","li[data-*]"]),function(t){t.registerOptions(function(t,e){t.features.poll=!!e.poll_enabled,t.pollMaximumOptions=e.poll_maximum_options}),t.registerPlugin(function(t){t.block.bbcode.ruler.push("poll",e)})}(t)};var v="data-poll-",_=["close","max","min","name","order","public","results","chartType","groups","status","step","type"];function y(t,e){t.push("text","",0).content="[/"+e+"]"}var e={tag:"poll",before:function(t,e,l){var o=t.push("text","",0);o.content=l,o.bbcode_attrs=e.attrs,o.bbcode_type="poll_open"},after:function(t,e,l){var o=function(t,e){var l=t.indexOf(e);if(-1!==l){var o=t.slice(l),n=o.findIndex(function(t){return"heading_open"===t.type}),i=o.findIndex(function(t){return"heading_close"===t.type});if(-1!==n&&-1!==i){var r=o.slice(n+1,i);return t.splice(l+n,i-n+1),r}}}(t.tokens,e),n=function(t,e){for(var l=t.length-1,o=[],n=[];t[l]!==e;l--){if(0===l)return;var i=t[l];if(0===i.level&&"ol"!==i.tag&&"ul"!==i.tag)return;if(1===i.level&&1===i.nesting){if("li"!==i.tag)return;o.push([i,n.reverse().join(" ")])}1===i.level&&1===i.nesting&&"li"===i.tag?n=[]:"text"!==i.type&&"inline"!==i.type||n.push(i.content)}return o.reverse()}(t.tokens,e);if(!n)return y(t,l);var i=e.bbcode_attrs,r=[["class","poll"]];i.status||r.push([v+"status","open"]),_.forEach(function(t){i[t]&&r.push([v+t,i[t]])}),i.name||r.push([v+"name","poll"]);var s=parseInt(i.min,10),a=parseInt(i.max,10),u=parseInt(i.step,10);u<1&&(u=1);var p=[],c=new t.Token("poll_open","div",1);if(c.block=!0,c.attrs=r,p.push(c),(c=new t.Token("poll_open","div",1)).block=!0,p.push(c),(c=new t.Token("poll_open","div",1)).attrs=[["class","poll-container"]],p.push(c),o&&((c=new t.Token("title_open","div",1)).attrs=[["class","poll-title"]],p.push(c),p.push.apply(p,g(o)),c=new t.Token("title_close","div",-1),p.push(c)),"number"===i.type){if(isNaN(s)&&(s=1),isNaN(a)&&(a=t.md.options.discourse.pollMaximumOptions),isNaN(u)&&(u=1),0<n.length)return y(t,l);c=new t.Token("bullet_list_open","ul",1),p.push(c);for(var d=s;d<=a;d+=u)c=new t.Token("list_item_open","li",1),n.push([c,String(d)]),p.push(c),(c=new t.Token("text","",0)).content=String(d),p.push(c),c=new t.Token("list_item_close","li",-1),p.push(c);c=new t.Token("bullet_item_close","",-1),p.push(c)}for(var f=0;f<n.length;f++){c=n[f][0];var h=n[f][1];c.attrs=c.attrs||[];var m=function(t){for(var e=0;e<t.length;e++)t[e]=x(t[e]);return t.join("")}(function(t){var e,l=(t=unescape(encodeURI(t))).length,o=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)O(o,w(t.substring(e-64,e)));t=t.substring(e-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)n[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),55<e)for(O(o,n),e=0;e<16;e++)n[e]=0;return n[14]=8*l,O(o,n),o}(JSON.stringify([h])));c.attrs.push([v+"option-id",m])}!function(t,e,l){var o=t.indexOf(e),n=t[o].level;for(t.splice.apply(t,[o,1].concat(g(l))),l[0].map=e.map;o<t.length;o++){var i=t[o].nesting;i<0&&n--,t[o].level=n,0<i&&n++}}(t.tokens,e,p),t.level=t.tokens[t.tokens.length-1].level,t.push("poll_close","div",-1),(c=t.push("poll_open","div",1)).attrs=[["class","poll-info"]],t.push("paragraph_open","p",1),(c=t.push("span_open","span",1)).block=!1,c.attrs=[["class","info-number"]],(c=t.push("text","",0)).content="0",t.push("span_close","span",-1),(c=t.push("span_open","span",1)).block=!1,c.attrs=[["class","info-label"]],(c=t.push("text","",0)).content=b.default.t("poll.voters",{count:0}),t.push("span_close","span",-1),t.push("paragraph_close","p",-1),t.push("poll_close","div",-1),t.push("poll_close","div",-1),t.push("poll_close","div",-1)}};function O(t,e){var l=t[0],o=t[1],n=t[2],i=t[3];l=r(l,o,n,i,e[0],7,-680876936),i=r(i,l,o,n,e[1],12,-389564586),n=r(n,i,l,o,e[2],17,606105819),o=r(o,n,i,l,e[3],22,-1044525330),l=r(l,o,n,i,e[4],7,-176418897),i=r(i,l,o,n,e[5],12,1200080426),n=r(n,i,l,o,e[6],17,-1473231341),o=r(o,n,i,l,e[7],22,-45705983),l=r(l,o,n,i,e[8],7,1770035416),i=r(i,l,o,n,e[9],12,-1958414417),n=r(n,i,l,o,e[10],17,-42063),o=r(o,n,i,l,e[11],22,-1990404162),l=r(l,o,n,i,e[12],7,1804603682),i=r(i,l,o,n,e[13],12,-40341101),n=r(n,i,l,o,e[14],17,-1502002290),l=a(l,o=r(o,n,i,l,e[15],22,1236535329),n,i,e[1],5,-165796510),i=a(i,l,o,n,e[6],9,-1069501632),n=a(n,i,l,o,e[11],14,643717713),o=a(o,n,i,l,e[0],20,-373897302),l=a(l,o,n,i,e[5],5,-701558691),i=a(i,l,o,n,e[10],9,38016083),n=a(n,i,l,o,e[15],14,-660478335),o=a(o,n,i,l,e[4],20,-405537848),l=a(l,o,n,i,e[9],5,568446438),i=a(i,l,o,n,e[14],9,-1019803690),n=a(n,i,l,o,e[3],14,-187363961),o=a(o,n,i,l,e[8],20,1163531501),l=a(l,o,n,i,e[13],5,-1444681467),i=a(i,l,o,n,e[2],9,-51403784),n=a(n,i,l,o,e[7],14,1735328473),l=u(l,o=a(o,n,i,l,e[12],20,-1926607734),n,i,e[5],4,-378558),i=u(i,l,o,n,e[8],11,-2022574463),n=u(n,i,l,o,e[11],16,1839030562),o=u(o,n,i,l,e[14],23,-35309556),l=u(l,o,n,i,e[1],4,-1530992060),i=u(i,l,o,n,e[4],11,1272893353),n=u(n,i,l,o,e[7],16,-155497632),o=u(o,n,i,l,e[10],23,-1094730640),l=u(l,o,n,i,e[13],4,681279174),i=u(i,l,o,n,e[0],11,-358537222),n=u(n,i,l,o,e[3],16,-722521979),o=u(o,n,i,l,e[6],23,76029189),l=u(l,o,n,i,e[9],4,-640364487),i=u(i,l,o,n,e[12],11,-421815835),n=u(n,i,l,o,e[15],16,530742520),l=p(l,o=u(o,n,i,l,e[2],23,-995338651),n,i,e[0],6,-198630844),i=p(i,l,o,n,e[7],10,1126891415),n=p(n,i,l,o,e[14],15,-1416354905),o=p(o,n,i,l,e[5],21,-57434055),l=p(l,o,n,i,e[12],6,1700485571),i=p(i,l,o,n,e[3],10,-1894986606),n=p(n,i,l,o,e[10],15,-1051523),o=p(o,n,i,l,e[1],21,-2054922799),l=p(l,o,n,i,e[8],6,1873313359),i=p(i,l,o,n,e[15],10,-30611744),n=p(n,i,l,o,e[6],15,-1560198380),o=p(o,n,i,l,e[13],21,1309151649),l=p(l,o,n,i,e[4],6,-145523070),i=p(i,l,o,n,e[11],10,-1120210379),n=p(n,i,l,o,e[2],15,718787259),o=p(o,n,i,l,e[9],21,-343485551),t[0]=c(l,t[0]),t[1]=c(o,t[1]),t[2]=c(n,t[2]),t[3]=c(i,t[3])}function s(t,e,l,o,n,i){return e=c(c(e,t),c(o,i)),c(e<<n|e>>>32-n,l)}function r(t,e,l,o,n,i,r){return s(e&l|~e&o,t,e,n,i,r)}function a(t,e,l,o,n,i,r){return s(e&o|l&~o,t,e,n,i,r)}function u(t,e,l,o,n,i,r){return s(e^l^o,t,e,n,i,r)}function p(t,e,l,o,n,i,r){return s(l^(e|~o),t,e,n,i,r)}function w(t){var e,l=[];for(e=0;e<64;e+=4)l[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return l}var n="0123456789abcdef".split("");function x(t){for(var e="",l=0;l<4;l++)e+=n[t>>8*l+4&15]+n[t>>8*l&15];return e}function c(t,e){return t+e&4294967295}}),Ember.TEMPLATES["javascripts/components/poll-breakdown-chart"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["@group"],"statements":[[7,"label",true],[10,"class","poll-breakdown-chart-label"],[8],[1,[23,1,[]],false],[9],[0,"\\n"],[7,"canvas",true],[10,"class","poll-breakdown-chart-chart"],[8],[9],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/discourse/templates/components/poll-breakdown-chart"}}),Ember.TEMPLATES["javascripts/components/poll-breakdown-option"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["@option","@onMouseOver","@onMouseOut"],"statements":[[7,"li",false],[12,"class","poll-breakdown-option"],[12,"style",[23,0,["colorBackgroundStyle"]]],[12,"role","button"],[3,"on",["mouseover",[23,2,[]]]],[3,"on",["mouseout",[23,3,[]]]],[8],[0,"\\n  "],[7,"span",true],[10,"class","poll-breakdown-option-color"],[11,"style",[23,0,["colorPreviewStyle"]]],[8],[9],[0,"\\n\\n  "],[7,"span",true],[10,"class","poll-breakdown-option-count"],[8],[0,"\\n"],[4,"if",[[24,["showPercentage"]]],null,{"statements":[[0,"      "],[1,[23,0,["percent"]],false],[0,"%\\n"]],"parameters":[]},{"statements":[[0,"      "],[1,[23,1,["votes"]],false],[0,"\\n"]],"parameters":[]}],[0,"  "],[9],[0,"\\n  "],[7,"span",true],[10,"class","poll-breakdown-option-text"],[8],[1,[28,"html-safe",[[23,1,["html"]]],null],false],[9],[0,"\\n"],[9],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/discourse/templates/components/poll-breakdown-option"}}),Ember.TEMPLATES["javascripts/modal/poll-ui-builder"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["option"],"statements":[[4,"d-modal-body",null,[["title","class"],["poll.ui_builder.title","poll-ui-builder"]],{"statements":[[0,"  "],[7,"div",true],[10,"class","input-group poll-type"],[8],[0,"\\n    "],[7,"a",false],[12,"href",""],[12,"class",[29,["poll-type-value ",[28,"if",[[24,["isRegular"]],"active"],null]]]],[3,"action",[[23,0,[]],[28,"mut",[[24,["pollType"]]],null],"regular"]],[8],[0,"\\n      "],[1,[28,"i18n",["poll.ui_builder.poll_type.regular"],null],false],[0,"\\n    "],[9],[0,"\\n\\n    "],[7,"a",false],[12,"href",""],[12,"class",[29,["poll-type-value ",[28,"if",[[24,["isMultiple"]],"active"],null]]]],[3,"action",[[23,0,[]],[28,"mut",[[24,["pollType"]]],null],"multiple"]],[8],[0,"\\n      "],[1,[28,"i18n",["poll.ui_builder.poll_type.multiple"],null],false],[0,"\\n    "],[9],[0,"\\n\\n"],[4,"if",[[24,["showNumber"]]],null,{"statements":[[0,"      "],[7,"a",false],[12,"href",""],[12,"class",[29,["poll-type-value ",[28,"if",[[24,["isNumber"]],"active"],null]]]],[3,"action",[[23,0,[]],[28,"mut",[[24,["pollType"]]],null],"number"]],[8],[0,"\\n        "],[1,[28,"i18n",["poll.ui_builder.poll_type.number"],null],false],[0,"\\n      "],[9],[0,"\\n"]],"parameters":[]},null],[0,"  "],[9],[0,"\\n\\n"],[4,"if",[[24,["showAdvanced"]]],null,{"statements":[[0,"    "],[7,"div",true],[10,"class","input-group poll-title"],[8],[0,"\\n      "],[7,"label",true],[10,"class","input-group-label"],[8],[1,[28,"i18n",["poll.ui_builder.poll_title.label"],null],false],[9],[0,"\\n      "],[1,[28,"input",null,[["value"],[[24,["pollTitle"]]]]],false],[0,"\\n    "],[9],[0,"\\n"]],"parameters":[]},null],[0,"\\n"],[4,"unless",[[24,["isNumber"]]],null,{"statements":[[0,"    "],[7,"div",true],[10,"class","poll-options"],[8],[0,"\\n"],[4,"if",[[24,["showAdvanced"]]],null,{"statements":[[0,"        "],[7,"label",true],[10,"class","input-group-label"],[8],[1,[28,"i18n",["poll.ui_builder.poll_options.label"],null],false],[9],[0,"\\n        "],[1,[28,"textarea",null,[["value","input"],[[24,["pollOptionsText"]],[28,"action",[[23,0,[]],"onOptionsTextChange"],null]]]],false],[0,"\\n\\n"],[4,"if",[[24,["showMinNumOfOptionsValidation"]]],null,{"statements":[[4,"unless",[[24,["minNumOfOptionsValidation","ok"]]],null,{"statements":[[0,"            "],[1,[28,"input-tip",null,[["validation"],[[24,["minNumOfOptionsValidation"]]]]],false],[0,"\\n"]],"parameters":[]},null]],"parameters":[]},null]],"parameters":[]},{"statements":[[4,"each",[[24,["pollOptions"]]],null,{"statements":[[0,"          "],[7,"div",true],[10,"class","input-group poll-option-value"],[8],[0,"\\n            "],[1,[28,"input",null,[["value","enter"],[[23,1,["value"]],[28,"action",[[23,0,[]],"addOption",[23,1,[]]],null]]]],false],[0,"\\n"],[4,"if",[[24,["canRemoveOption"]]],null,{"statements":[[0,"              "],[1,[28,"d-button",null,[["icon","action"],["trash-alt",[28,"action",[[23,0,[]],"removeOption",[23,1,[]]],null]]]],false],[0,"\\n"]],"parameters":[]},null],[0,"          "],[9],[0,"\\n"]],"parameters":[1]},null],[0,"\\n        "],[7,"div",true],[10,"class","poll-option-controls"],[8],[0,"\\n          "],[1,[28,"d-button",null,[["class","icon","label","action"],["btn-default","plus","poll.ui_builder.poll_options.add",[28,"action",[[23,0,[]],"addOption",[24,["pollOptions","lastObject"]]],null]]]],false],[0,"\\n"],[4,"if",[[28,"and",[[24,["showMinNumOfOptionsValidation"]],[28,"not",[[24,["minNumOfOptionsValidation","ok"]]],null]],null]],null,{"statements":[[0,"            "],[1,[28,"input-tip",null,[["validation"],[[24,["minNumOfOptionsValidation"]]]]],false],[0,"\\n"]],"parameters":[]},null],[0,"        "],[9],[0,"\\n"]],"parameters":[]}],[0,"    "],[9],[0,"\\n"]],"parameters":[]},null],[0,"\\n"],[4,"unless",[[24,["isRegular"]]],null,{"statements":[[0,"    "],[7,"div",true],[10,"class","options"],[8],[0,"\\n      "],[7,"div",true],[10,"class","input-group poll-number"],[8],[0,"\\n        "],[7,"label",true],[10,"class","input-group-label"],[8],[1,[28,"i18n",["poll.ui_builder.poll_config.min"],null],false],[9],[0,"\\n        "],[1,[28,"input",null,[["type","value","valueProperty","class","min"],["number",[24,["pollMin"]],"value","poll-options-min",1]]],false],[0,"\\n      "],[9],[0,"\\n\\n      "],[7,"div",true],[10,"class","input-group poll-number"],[8],[0,"\\n        "],[7,"label",true],[10,"class","input-group-label"],[8],[1,[28,"i18n",["poll.ui_builder.poll_config.max"],null],false],[9],[0,"\\n        "],[1,[28,"input",null,[["type","value","valueProperty","class","min"],["number",[24,["pollMax"]],"value","poll-options-max",1]]],false],[0,"\\n      "],[9],[0,"\\n\\n"],[4,"if",[[24,["isNumber"]]],null,{"statements":[[0,"        "],[7,"div",true],[10,"class","input-group poll-number"],[8],[0,"\\n          "],[7,"label",true],[10,"class","input-group-label"],[8],[1,[28,"i18n",["poll.ui_builder.poll_config.step"],null],false],[9],[0,"\\n          "],[1,[28,"input",null,[["type","value","valueProperty","min","class"],["number",[24,["pollStep"]],"value","1","poll-options-step"]]],false],[0,"\\n        "],[9],[0,"\\n"]],"parameters":[]},null],[0,"    "],[9],[0,"\\n\\n"],[4,"unless",[[24,["minMaxValueValidation","ok"]]],null,{"statements":[[0,"      "],[1,[28,"input-tip",null,[["validation"],[[24,["minMaxValueValidation"]]]]],false],[0,"\\n"]],"parameters":[]},null]],"parameters":[]},null],[0,"\\n"],[4,"if",[[24,["showAdvanced"]]],null,{"statements":[[0,"    "],[7,"div",true],[10,"class","input-group poll-allowed-groups"],[8],[0,"\\n      "],[7,"label",true],[10,"class","input-group-label"],[8],[1,[28,"i18n",["poll.ui_builder.poll_groups.label"],null],false],[9],[0,"\\n      "],[1,[28,"group-chooser",null,[["content","value","onChange","labelProperty","valueProperty"],[[24,["siteGroups"]],[24,["pollGroups"]],[28,"action",[[23,0,[]],[28,"mut",[[24,["pollGroups"]]],null]],null],"name","name"]]],false],[0,"\\n    "],[9],[0,"\\n\\n    "],[7,"div",true],[10,"class","input-group poll-date"],[8],[0,"\\n      "],[7,"label",true],[10,"class","input-group-label"],[8],[1,[28,"i18n",["poll.ui_builder.automatic_close.label"],null],false],[9],[0,"\\n      "],[1,[28,"date-time-input",null,[["date","onChange","clearable","useGlobalPickerContainer"],[[24,["pollAutoClose"]],[28,"action",[[23,0,[]],[28,"mut",[[24,["pollAutoClose"]]],null]],null],true,true]]],false],[0,"\\n    "],[9],[0,"\\n\\n    "],[7,"div",true],[10,"class","input-group poll-select"],[8],[0,"\\n      "],[7,"label",true],[10,"class","input-group-label"],[8],[1,[28,"i18n",["poll.ui_builder.poll_result.label"],null],false],[9],[0,"\\n      "],[1,[28,"combo-box",null,[["content","value","class","valueProperty","onChange"],[[24,["pollResults"]],[24,["pollResult"]],"poll-result","value",[28,"action",[[23,0,[]],[28,"mut",[[24,["pollResult"]]],null]],null]]]],false],[0,"\\n    "],[9],[0,"\\n\\n"],[4,"unless",[[24,["isNumber"]]],null,{"statements":[[0,"      "],[7,"div",true],[10,"class","input-group poll-select column"],[8],[0,"\\n        "],[7,"label",true],[10,"class","input-group-label"],[8],[1,[28,"i18n",["poll.ui_builder.poll_chart_type.label"],null],false],[9],[0,"\\n\\n        "],[7,"div",true],[10,"class","radio-group"],[8],[0,"\\n          "],[1,[28,"radio-button",null,[["id","name","value","selection"],["poll-chart-type-bar","poll-chart-type","bar",[24,["chartType"]]]]],false],[0,"\\n          "],[7,"label",true],[10,"for","poll-chart-type-bar"],[8],[1,[28,"d-icon",["chart-bar"],null],false],[0," "],[1,[28,"i18n",["poll.ui_builder.poll_chart_type.bar"],null],false],[9],[0,"\\n        "],[9],[0,"\\n\\n        "],[7,"div",true],[10,"class","radio-group"],[8],[0,"\\n          "],[1,[28,"radio-button",null,[["id","name","value","selection"],["poll-chart-type-pie","poll-chart-type","pie",[24,["chartType"]]]]],false],[0,"\\n          "],[7,"label",true],[10,"for","poll-chart-type-pie"],[8],[1,[28,"d-icon",["chart-pie"],null],false],[0," "],[1,[28,"i18n",["poll.ui_builder.poll_chart_type.pie"],null],false],[9],[0,"\\n        "],[9],[0,"\\n      "],[9],[0,"\\n"]],"parameters":[]},null],[0,"\\n"],[4,"unless",[[24,["isPie"]]],null,{"statements":[[0,"      "],[7,"div",true],[10,"class","input-group poll-checkbox column"],[8],[0,"\\n        "],[7,"label",true],[8],[0,"\\n          "],[1,[28,"input",null,[["type","checked"],["checkbox",[24,["publicPoll"]]]]],false],[0,"\\n          "],[1,[28,"i18n",["poll.ui_builder.poll_public.label"],null],false],[0,"\\n        "],[9],[0,"\\n      "],[9],[0,"\\n"]],"parameters":[]},null]],"parameters":[]},null]],"parameters":[]},null],[0,"\\n"],[7,"div",true],[10,"class","modal-footer"],[8],[0,"\\n  "],[1,[28,"d-button",null,[["action","icon","class","label","disabled"],[[28,"action",[[23,0,[]],"insertPoll"],null],"chart-bar","btn-primary","poll.ui_builder.insert",[24,["disableInsert"]]]]],false],[0,"\\n\\n  "],[1,[28,"d-button",null,[["label","class","action"],["cancel","btn-flat",[28,"route-action",["closeModal"],null]]]],false],[0,"\\n\\n  "],[1,[28,"d-button",null,[["action","class","icon","title"],[[28,"action",[[23,0,[]],"toggleAdvanced"],null],"btn-default show-advanced","cog",[28,"if",[[24,["showAdvanced"]],"poll.ui_builder.hide_advanced","poll.ui_builder.show_advanced"],null]]]],false],[0,"\\n"],[9],[0,"\\n"]],"hasEval":false}',meta:{moduleName:"javascripts/discourse/templates/modal/poll-ui-builder"}}),Ember.TEMPLATES["javascripts/modal/poll-breakdown"]=Ember.HTMLBars.template({id:null,block:'{"symbols":["chart","option","index"],"statements":[[4,"d-modal-body",null,[["title"],["poll.breakdown.title"]],{"statements":[[0,"  "],[7,"div",true],[10,"class","poll-breakdown-sidebar"],[8],[0,"\\n    "],[7,"p",true],[10,"class","poll-breakdown-title"],[8],[0,"\\n      "],[1,[23,0,["title"]],false],[0,"\\n    "],[9],[0,"\\n\\n    "],[7,"div",true],[10,"class","poll-breakdown-total-votes"],[8],[1,[28,"i18n",["poll.breakdown.votes"],[["count"],[[23,0,["model","poll","voters"]]]]],false],[9],[0,"\\n\\n    "],[7,"ul",true],[10,"class","poll-breakdown-options"],[8],[0,"\\n"],[4,"each",[[23,0,["model","poll","options"]]],null,{"statements":[[0,"        "],[1,[28,"poll-breakdown-option",null,[["option","index","totalVotes","optionsCount","displayMode","highlightedOption","onMouseOver","onMouseOut"],[[23,2,[]],[23,3,[]],[23,0,["totalVotes"]],[23,0,["model","poll","options","length"]],[23,0,["displayMode"]],[23,0,["highlightedOption"]],[28,"fn",[[28,"mut",[[23,0,["highlightedOption"]]],null],[23,3,[]]],null],[28,"fn",[[28,"mut",[[23,0,["highlightedOption"]]],null],null],null]]]],false],[0,"\\n"]],"parameters":[2,3]},null],[0,"    "],[9],[0,"\\n  "],[9],[0,"\\n\\n  "],[7,"div",true],[10,"class","poll-breakdown-body"],[8],[0,"\\n    "],[7,"div",true],[10,"class","poll-breakdown-body-header"],[8],[0,"\\n      "],[7,"label",true],[10,"class","poll-breakdown-body-header-label"],[8],[1,[28,"i18n",["poll.breakdown.breakdown"],null],false],[9],[0,"\\n\\n      "],[1,[28,"combo-box",null,[["content","value","nameProperty","class","onChange"],[[23,0,["groupableUserFields"]],[23,0,["groupedBy"]],"label","poll-breakdown-dropdown",[28,"action",[[23,0,[]],[23,0,["setGrouping"]]],null]]]],false],[0,"\\n    "],[9],[0,"\\n\\n    "],[7,"div",true],[10,"class","poll-breakdown-charts"],[8],[0,"\\n"],[4,"each",[[23,0,["charts"]]],null,{"statements":[[0,"        "],[1,[28,"poll-breakdown-chart",null,[["group","options","displayMode","highlightedOption","setHighlightedOption"],[[28,"get",[[23,1,[]],"group"],null],[28,"get",[[23,1,[]],"options"],null],[23,0,["displayMode"]],[23,0,["highlightedOption"]],[28,"fn",[[28,"mut",[[23,0,["highlightedOption"]]],null]],null]]]],false],[0,"\\n"]],"parameters":[1]},null],[0,"    "],[9],[0,"\\n  "],[9],[0,"\\n"]],"parameters":[]},null]],"hasEval":false}',meta:{moduleName:"javascripts/discourse/templates/modal/poll-breakdown"}}),define("discourse/plugins/poll/components/poll-breakdown-chart",["exports","@ember/component","I18n","discourse/plugins/poll/controllers/poll-ui-builder","discourse-common/utils/decorators","discourse/plugins/poll/lib/chart-colors","@ember/template","@ember/object/computed"],function(t,e,a,u,l,p,o,n){"use strict";var i,r,s;function c(l,o,t,e,n){var i={};return Object.keys(e).forEach(function(t){i[t]=e[t]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=t.slice().reverse().reduce(function(t,e){return e(l,o,t)||t},i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(l,o,i),i=null),i}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var d=e.default.extend((i=(0,l.default)("optionColors","index"),r=(0,l.default)("data","displayMode"),c(s={group:null,options:null,displayMode:null,highlightedOption:null,setHighlightedOption:null,classNames:"poll-breakdown-chart-container",_optionToSlice:null,_previousHighlightedSliceIndex:null,_previousDisplayMode:null,data:(0,n.mapBy)("options","votes"),init:function(){this._super.apply(this,arguments),this._optionToSlice={}},didInsertElement:function(){this._super.apply(this,arguments);var t=this.element.querySelector("canvas");this._chart=new window.Chart(t.getContext("2d"),this.chartConfig)},didReceiveAttrs:function(){this._super.apply(this,arguments),this._chart&&(this._updateDisplayMode(),this._updateHighlight())},willDestroy:function(){this._super.apply(this,arguments),this._chart&&this._chart.destroy()},colorStyle:function(t,e){return(0,o.htmlSafe)("background: ".concat(t[e],";"))},chartConfig:function(l,o){var n=this,i=[],r=0;this._optionToSlice={},l.forEach(function(t,e){0<t&&(i.push(t),n._optionToSlice[e]=r++)});var s=i.reduce(function(t,e){return t+e},0),t=(0,p.getColors)(l.length).filter(function(t,e){return 0<l[e]});return{type:u.PIE_CHART_TYPE,plugins:[window.ChartDataLabels],data:{datasets:[{data:i,backgroundColor:t,hoverBorderColor:"#fff"}]},options:{plugins:{datalabels:{color:"#333",backgroundColor:"rgba(255, 255, 255, 0.5)",borderRadius:2,font:{family:getComputedStyle(document.body).fontFamily,size:16},padding:{top:2,right:6,bottom:2,left:6},formatter:function(t){if("percentage"!==o)return t;var e=a.default.toNumber(t/s*100,{precision:1});return"".concat(e,"%")}}},responsive:!0,aspectRatio:1.1,animation:{duration:0},tooltips:!1,onHover:function(t,e){if(e.length){var l=e[0]._index,o=Object.keys(n._optionToSlice).find(function(t){return n._optionToSlice[t]===l});e.length=0,n.setHighlightedOption(Number(o))}else n.setHighlightedOption(null)}}}},_updateDisplayMode:function(){if(this.displayMode!==this._previousDisplayMode){var t=this.chartConfig;this._chart.data.datasets=t.data.datasets,this._chart.options=t.options,this._chart.update(),this._previousDisplayMode=this.displayMode}},_updateHighlight:function(){var t=this._chart.getDatasetMeta(0);if(null!==this._previousHighlightedSliceIndex){var e=t.data[this._previousHighlightedSliceIndex];t.controller.removeHoverStyle(e),this._chart.draw()}if(null!==this.highlightedOption){var l=this._optionToSlice[this.highlightedOption];if(void 0!==l){var o=t.data[l];this._previousHighlightedSliceIndex=l,t.controller.setHoverStyle(o),this._chart.draw()}else this._previousHighlightedSliceIndex=null}else this._previousHighlightedSliceIndex=null}},"colorStyle",[i],Object.getOwnPropertyDescriptor(s,"colorStyle"),s),c(s,"chartConfig",[r],Object.getOwnPropertyDescriptor(s,"chartConfig"),s),s));t.default=d}),define("discourse/plugins/poll/components/poll-breakdown-option",["exports","@ember/component","I18n","@ember/object","discourse-common/utils/decorators","@ember/object/computed","discourse/plugins/poll/lib/chart-colors","@ember/template","discourse/lib/computed"],function(t,e,l,o,n,i,r,s,a){"use strict";var u,p,c,d,f;function h(l,o,t,e,n){var i={};return Object.keys(e).forEach(function(t){i[t]=e[t]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=t.slice().reverse().reduce(function(t,e){return e(l,o,t)||t},i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(l,o,i),i=null),i}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var m=e.default.extend((u=(0,n.default)("option.votes","totalVotes"),p=(0,n.default)("optionsCount"),c=(0,n.default)("highlighted"),d=(0,n.default)("highlighted","optionColors","index"),h(f={option:null,index:null,totalVotes:null,optionsCount:null,displayMode:null,highlightedOption:null,onMouseOver:null,onMouseOut:null,tagName:"",highlighted:(0,a.propertyEqual)("highlightedOption","index"),showPercentage:(0,i.equal)("displayMode","percentage"),percent:function(t,e){return l.default.toNumber(t/e*100,{precision:1})},optionColors:function(t){return(0,r.getColors)(t)},colorBackgroundStyle:function(t){if(t)return(0,s.htmlSafe)("background: rgba(0, 0, 0, 0.1);")},colorPreviewStyle:function(t,e,l){var o=t?window.Chart.helpers.getHoverColor(e[l]):e[l];return(0,s.htmlSafe)("background: ".concat(o,";"))},onHover:function(t){t?this.onMouseOver():this.onMouseOut()}},"percent",[u],Object.getOwnPropertyDescriptor(f,"percent"),f),h(f,"optionColors",[p],Object.getOwnPropertyDescriptor(f,"optionColors"),f),h(f,"colorBackgroundStyle",[c],Object.getOwnPropertyDescriptor(f,"colorBackgroundStyle"),f),h(f,"colorPreviewStyle",[d],Object.getOwnPropertyDescriptor(f,"colorPreviewStyle"),f),h(f,"onHover",[o.action],Object.getOwnPropertyDescriptor(f,"onHover"),f),f));t.default=m}),define("discourse/plugins/poll/controllers/poll-ui-builder",["exports","@ember/controller","@ember/object","@ember/object/computed","@ember/runloop","discourse-common/utils/decorators","discourse/mixins/modal-functionality","I18n"],function(t,e,s,l,r,o,n,a){"use strict";var i,u,p,c,d,f,h,m,b,g,v,_,y;function O(t){return function(t){if(Array.isArray(t))return w(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return w(t,e);var l=Object.prototype.toString.call(t).slice(8,-1);"Object"===l&&t.constructor&&(l=t.constructor.name);if("Map"===l||"Set"===l)return Array.from(t);if("Arguments"===l||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return w(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var l=0,o=new Array(e);l<e;l++)o[l]=t[l];return o}function x(l,o,t,e,n){var i={};return Object.keys(e).forEach(function(t){i[t]=e[t]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=t.slice().reverse().reduce(function(t,e){return e(l,o,t)||t},i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(l,o,i),i=null),i}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MULTIPLE_POLL_TYPE=t.NUMBER_POLL_TYPE=t.REGULAR_POLL_TYPE=t.PIE_CHART_TYPE=t.BAR_CHART_TYPE=void 0;t.BAR_CHART_TYPE="bar";t.PIE_CHART_TYPE="pie";var P="regular";t.REGULAR_POLL_TYPE=P;var M="number";t.NUMBER_POLL_TYPE=M;var j="multiple";t.MULTIPLE_POLL_TYPE=j;var C="always",k=e.default.extend(n.default,(i=(0,o.default)("pollType"),u=(0,o.default)("pollType"),p=(0,o.default)("pollType"),c=(0,o.default)("pollOptions.@each.value"),d=(0,o.default)("site.groups"),f=(0,o.default)("chartType","pollType"),h=(0,o.observes)("pollType","pollOptionsCount"),m=(0,o.default)("pollType","pollResult","publicPoll","pollTitle","pollOptions.@each.value","pollMin","pollMax","pollStep","pollGroups","pollAutoClose","chartType"),b=(0,o.default)("isNumber","pollOptionsCount"),g=(0,o.default)("pollOptions.@each.value"),v=(0,o.default)("isMultiple","pollOptionsCount","isNumber","pollMin","pollMax","pollStep"),_=(0,o.default)("minMaxValueValidation","minNumOfOptionsValidation"),x(y={showAdvanced:!1,pollType:P,pollTitle:"",pollOptions:null,pollOptionsText:null,pollMin:1,pollMax:2,pollStep:1,pollGroups:null,pollAutoClose:null,pollResult:C,chartType:"bar",publicPoll:null,onShow:function(){this.setProperties({showAdvanced:!1,pollType:P,pollTitle:null,pollOptions:[s.default.create({value:""})],pollOptionsText:"",pollMin:1,pollMax:2,pollStep:1,pollGroups:null,pollAutoClose:null,pollResult:C,chartType:"bar",publicPoll:!1})},pollResults:function(){var t=[{name:a.default.t("poll.ui_builder.poll_result.always"),value:C},{name:a.default.t("poll.ui_builder.poll_result.vote"),value:"on_vote"},{name:a.default.t("poll.ui_builder.poll_result.closed"),value:"on_close"}];return this.get("currentUser.staff")&&t.push({name:a.default.t("poll.ui_builder.poll_result.staff"),value:"staff_only"}),t},isRegular:function(t){return t===P},isNumber:function(t){return t===M},isMultiple:function(t){return t===j},showNumber:(0,l.or)("showAdvanced","isNumber"),pollOptionsCount:function(t){return t.filter(function(t){return 0<t.value.length}).length},siteGroups:function(t){return t.filter(function(t){return 0!==t.id})},isPie:function(t,e){return e!==M&&"pie"===t},canRemoveOption:(0,l.gt)("pollOptions.length",1),_setPollMinMax:function(){this.isMultiple?((this.pollMin<=0||this.pollMin>=this.pollMax||this.pollMin>=this.pollOptionsCount)&&this.set("pollMin",0<this.pollOptionsCount?1:0),(this.pollMax<=0||this.pollMin>=this.pollMax||this.pollMax>this.pollOptionsCount)&&this.set("pollMax",this.pollOptionsCount)):this.isNumber&&this.set("pollMax",this.siteSettings.poll_maximum_options)},pollOutput:function(t,e,l,o,n,i,r,s,a,u,p){var c="[poll",d="",f=this.toolbarEvent.getText().match(/\[poll(\s+name=[^\s\]]+)*.*\]/gim);f&&(c+=" name=poll".concat(f.length+1));var h=s;return h<1&&(h=1),t&&(c+=" type=".concat(t)),e&&(c+=" results=".concat(e)),i&&t!==P&&(c+=" min=".concat(i)),r&&t!==P&&(c+=" max=".concat(r)),t===M&&(c+=" step=".concat(h)),l&&(c+=" public=true"),p&&t!==M&&(c+=" chartType=".concat(p)),a&&0<a.length&&(c+=" groups=".concat(a)),u&&(c+=" close=".concat(u.toISOString())),d+="".concat(c+="]","\n"),o&&(d+="# ".concat(o.trim(),"\n")),0<n.length&&t!==M&&n.forEach(function(t){0<t.value.length&&(d+="* ".concat(t.value.trim(),"\n"))}),d+="[/poll]\n"},minNumOfOptionsValidation:function(t,e){if(!t){if(e<1)return s.default.create({failed:!0,reason:a.default.t("poll.ui_builder.help.options_min_count")});if(e>this.siteSettings.poll_maximum_options)return s.default.create({failed:!0,reason:a.default.t("poll.ui_builder.help.options_max_count",{count:this.siteSettings.poll_maximum_options})})}return s.default.create({ok:!0})},showMinNumOfOptionsValidation:function(t){return 1!==t.length||""!==t[0].value},minMaxValueValidation:function(t,e,l,o,n,i){if(o=parseInt(o,10)||0,n=parseInt(n,10)||0,i=parseInt(i,10)||0,o<0)return s.default.create({failed:!0,reason:a.default.t("poll.ui_builder.help.invalid_min_value")});if(n<0||t&&e<n)return s.default.create({failed:!0,reason:a.default.t("poll.ui_builder.help.invalid_max_value")});if(n<o)return s.default.create({failed:!0,reason:a.default.t("poll.ui_builder.help.invalid_values")});if(l){if(i<1)return s.default.create({failed:!0,reason:a.default.t("poll.ui_builder.help.min_step_value")});var r=(n-o+1)/i;if(r<1)return s.default.create({failed:!0,reason:a.default.t("poll.ui_builder.help.options_min_count")});if(r>this.siteSettings.poll_maximum_options)return s.default.create({failed:!0,reason:a.default.t("poll.ui_builder.help.options_max_count",{count:this.siteSettings.poll_maximum_options})})}return s.default.create({ok:!0})},disableInsert:function(t,e){return!t.ok||!e.ok},_comboboxOptions:function(e,t){return O(Array(t-e).keys()).map(function(t){return{value:t+e,name:t+e}})},onOptionsTextChange:function(t){var e=0;this.set("pollOptions",t.target.value.split("\n").map(function(t){return s.default.create({idx:e++,value:t})}))},insertPoll:function(){this.toolbarEvent.addText(this.pollOutput),this.send("closeModal")},toggleAdvanced:function(){this.toggleProperty("showAdvanced"),this.showAdvanced&&this.set("pollOptionsText",this.pollOptions.map(function(t){return t.value}).join("\n"))},addOption:function(t,e,l){if(""!==e){var o=this.pollOptions.indexOf(t)+1,n=s.default.create({value:""});this.pollOptions.insertAt(o,n);var i=0;this.pollOptions.forEach(function(t){return t.set("idx",i++)}),(0,r.next)(function(){var t=document.getElementsByClassName("poll-options");if(t){var e=t[0].getElementsByTagName("input");n.idx<e.length&&e[n.idx].focus()}})}l&&l.preventDefault()},removeOption:function(t){this.pollOptions.removeObject(t)}},"pollResults",[o.default],Object.getOwnPropertyDescriptor(y,"pollResults"),y),x(y,"isRegular",[i],Object.getOwnPropertyDescriptor(y,"isRegular"),y),x(y,"isNumber",[u],Object.getOwnPropertyDescriptor(y,"isNumber"),y),x(y,"isMultiple",[p],Object.getOwnPropertyDescriptor(y,"isMultiple"),y),x(y,"pollOptionsCount",[c],Object.getOwnPropertyDescriptor(y,"pollOptionsCount"),y),x(y,"siteGroups",[d],Object.getOwnPropertyDescriptor(y,"siteGroups"),y),x(y,"isPie",[f],Object.getOwnPropertyDescriptor(y,"isPie"),y),x(y,"_setPollMinMax",[h],Object.getOwnPropertyDescriptor(y,"_setPollMinMax"),y),x(y,"pollOutput",[m],Object.getOwnPropertyDescriptor(y,"pollOutput"),y),x(y,"minNumOfOptionsValidation",[b],Object.getOwnPropertyDescriptor(y,"minNumOfOptionsValidation"),y),x(y,"showMinNumOfOptionsValidation",[g],Object.getOwnPropertyDescriptor(y,"showMinNumOfOptionsValidation"),y),x(y,"minMaxValueValidation",[v],Object.getOwnPropertyDescriptor(y,"minMaxValueValidation"),y),x(y,"disableInsert",[_],Object.getOwnPropertyDescriptor(y,"disableInsert"),y),x(y,"onOptionsTextChange",[s.action],Object.getOwnPropertyDescriptor(y,"onOptionsTextChange"),y),x(y,"insertPoll",[s.action],Object.getOwnPropertyDescriptor(y,"insertPoll"),y),x(y,"toggleAdvanced",[s.action],Object.getOwnPropertyDescriptor(y,"toggleAdvanced"),y),x(y,"addOption",[s.action],Object.getOwnPropertyDescriptor(y,"addOption"),y),x(y,"removeOption",[s.action],Object.getOwnPropertyDescriptor(y,"removeOption"),y),y));t.default=k}),define("discourse/plugins/poll/controllers/poll-breakdown",["exports","@ember/controller","I18n","discourse/mixins/modal-functionality","@ember/object","discourse/lib/ajax","@ember/string","discourse-common/utils/decorators","@ember/template","discourse/lib/load-script","discourse/lib/ajax-error"],function(t,e,l,o,n,i,r,s,a,u,p){"use strict";var c,d,f,h;function m(l,o,t,e,n){var i={};return Object.keys(e).forEach(function(t){i[t]=e[t]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=t.slice().reverse().reduce(function(t,e){return e(l,o,t)||t},i),n&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(n):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(l,o,i),i=null),i}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var b=e.default.extend(o.default,(c=(0,s.default)("model.poll.title","model.post.topic.title"),d=(0,s.default)("model.groupableUserFields"),f=(0,s.default)("model.poll.options"),m(h={model:null,charts:null,groupedBy:null,highlightedOption:null,displayMode:"percentage",title:function(t,e){return t?(0,a.htmlSafe)(t):e},groupableUserFields:function(t){return t.map(function(t){var e=t.split("_").filter(Boolean);return 1<e.length&&(e[0]=(0,r.classify)(e[0])),{id:t,label:e.join(" ")}})},totalVotes:function(t){return t.reduce(function(t,e){return t+e.votes},0)},onShow:function(){var t=this;this.set("charts",null),this.set("displayMode","percentage"),this.set("groupedBy",this.model.groupableUserFields[0]),(0,u.default)("/javascripts/Chart.min.js").then(function(){return(0,u.default)("/javascripts/chartjs-plugin-datalabels.min.js")}).then(function(){window.Chart.plugins.unregister(window.ChartDataLabels),t.fetchGroupedPollData()})},fetchGroupedPollData:function(){var e=this;return(0,i.ajax)("/polls/grouped_poll_results.json",{data:{post_id:this.model.post.id,poll_name:this.model.poll.name,user_field_name:this.groupedBy}}).catch(function(t){t?(0,p.popupAjaxError)(t):bootbox.alert(l.default.t("poll.error_while_fetching_voters"))}).then(function(t){e.isDestroying||e.isDestroyed||e.set("charts",t.grouped_results)})},setGrouping:function(t){this.set("groupedBy",t),this.fetchGroupedPollData()},onSelectPanel:function(t){this.set("displayMode",t.id)}},"title",[c],Object.getOwnPropertyDescriptor(h,"title"),h),m(h,"groupableUserFields",[d],Object.getOwnPropertyDescriptor(h,"groupableUserFields"),h),m(h,"totalVotes",[f],Object.getOwnPropertyDescriptor(h,"totalVotes"),h),m(h,"setGrouping",[n.action],Object.getOwnPropertyDescriptor(h,"setGrouping"),h),m(h,"onSelectPanel",[n.action],Object.getOwnPropertyDescriptor(h,"onSelectPanel"),h),h));t.default=b}),define("discourse/plugins/poll/widgets/discourse-poll",["exports","I18n","discourse/plugins/poll/controllers/poll-ui-builder","discourse/widgets/raw-html","discourse/lib/ajax","discourse/widgets/post","discourse/widgets/widget","discourse/plugins/poll/lib/even-round","discourse/plugins/poll/lib/chart-colors","virtual-dom","discourse-common/lib/icon-library","discourse/lib/load-script","discourse/lib/ajax-error","discourse/lib/formatter","discourse/lib/round","discourse/lib/show-modal"],function(t,y,a,O,r,o,e,n,i,c,s,l,u,w,p,d){"use strict";function f(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var l=Object.prototype.toString.call(t).slice(8,-1);"Object"===l&&t.constructor&&(l=t.constructor.name);if("Map"===l||"Set"===l)return Array.from(t);if("Arguments"===l||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return h(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var l=0,o=new Array(e);l<e;l++)o[l]=t[l];return o}function m(t){var e=$("<span>".concat(t.html,"</span>"));return e.find(".discourse-local-date").each(function(t,e){$(e).applyLocalDates()}),new O.default({html:"<span>".concat(e.html(),"</span>")})}function x(t){return new O.default({html:'<span class="info-text">'.concat(t,"</span>")})}function b(t){return(0,r.ajax)("/polls/voters.json",{data:t}).catch(function(t){t?(0,u.popupAjaxError)(t):bootbox.alert(y.default.t("poll.error_while_fetching_voters"))})}function g(t,e){var l=e&&e.groups&&e.groups.split(",").map(function(t){return t.toLowerCase()});if(!l)return 1;var o=t&&t.groups&&t.groups.map(function(t){return t.name.toLowerCase()});return o&&l.some(function(t){return o.includes(t)})}Object.defineProperty(t,"__esModule",{value:!0}),(t.default=void 0,e.createWidget)("discourse-poll-option",{tagName:"li",buildAttributes:function(t){return{tabindex:0,"data-poll-option-id":t.option.id}},html:function(t){var e=[],l=t.option,o=t.vote.includes(l.id);return t.isMultiple?e.push((0,s.iconNode)(o?"far-check-square":"far-square")):e.push((0,s.iconNode)(o?"circle":"far-circle")),e.push(" "),e.push(m(l)),e},click:function(t){0===$(t.target).closest("a").length&&this.sendWidgetAction("toggleOption",this.attrs.option)},keyDown:function(t){13===t.keyCode&&this.click(t)}}),(0,e.createWidget)("discourse-poll-load-more",{tagName:"div.poll-voters-toggle-expand",buildKey:function(t){return"load-more-".concat(t.optionId)},defaultState:function(){return{loading:!1}},html:function(t,e){return e.loading?(0,c.h)("div.spinner.small"):(0,c.h)("a",(0,s.iconNode)("chevron-down"))},click:function(){var t=this.state;if(!t.loading)return t.loading=!0,this.sendWidgetAction("loadMore").finally(function(){return t.loading=!1})}}),(0,e.createWidget)("discourse-poll-voters",{tagName:"ul.poll-voters-list",buildKey:function(t){return"poll-voters-".concat(t.optionId)},defaultState:function(){return{loaded:"new",voters:[],page:1}},fetchVoters:function(){var o=this,n=this.attrs,i=this.state;if("loading"!==i.loaded)return i.loaded="loading",b({post_id:n.postId,poll_name:n.pollName,option_id:n.optionId,page:i.page}).then(function(t){i.loaded="loaded",i.page+=1;var e="number"===n.pollType?t.voters:t.voters[n.optionId],l=new Set(i.voters.map(function(t){return t.username}));e.forEach(function(t){l.has(t.username)||(l.add(t.username),i.voters.push(t))}),o.scheduleRerender()})},loadMore:function(){return this.fetchVoters()},html:function(t,e){t.voters&&"new"===e.loaded&&(e.voters=t.voters);var l=e.voters.map(function(t){return(0,c.h)("li",[(0,o.avatarFor)("tiny",{username:t.username,template:t.avatar_template})," "])});return e.voters.length<t.totalVotes&&l.push(this.attach("discourse-poll-load-more",t)),(0,c.h)("div.poll-voters",l)}}),(0,e.createWidget)("discourse-poll-standard-results",{tagName:"ul.results",buildKey:function(t){return"poll-standard-results-".concat(t.id)},defaultState:function(){return{loaded:!1}},fetchVoters:function(){var e=this,t=this.attrs,l=this.state;return b({post_id:t.post.id,poll_name:t.poll.get("name")}).then(function(t){l.voters=t.voters,e.scheduleRerender()})},html:function(i,r){var s=this,a=i.poll,t=a.get("options");if(t){var e=a.get("voters"),u=a.get("public"),l=f(t).sort(function(t,e){return!(t.votes<e.votes)&&(t.votes!==e.votes||t.html<e.html)?-1:1});u&&!r.loaded&&(r.voters=a.get("preloaded_voters"),r.loaded=!0);var o=0===e?Array(l.length).fill(0):l.map(function(t){return 100*t.votes/e}),p=i.isMultiple?o.map(Math.floor):(0,n.default)(o);return l.map(function(t,e){var l=[],o=p[e].toString(),n=(i.vote||[]).includes(t.id);return l.push((0,c.h)("div.option",(0,c.h)("p",[(0,c.h)("span.percentage","".concat(o,"%")),m(t)]))),l.push((0,c.h)("div.bar-back",(0,c.h)("div.bar",{attributes:{style:"width:".concat(o,"%")}}))),u&&l.push(s.attach("discourse-poll-voters",{postId:i.post.id,optionId:t.id,pollName:a.get("name"),totalVotes:t.votes,voters:r.voters&&r.voters[t.id]||[]})),(0,c.h)("li",{className:"".concat(n?"chosen":"")},l)})}}}),(0,e.createWidget)("discourse-poll-number-results",{buildKey:function(t){return"poll-number-results-".concat(t.id)},defaultState:function(){return{loaded:!1}},fetchVoters:function(){var e=this,t=this.attrs,l=this.state;return b({post_id:t.post.id,poll_name:t.poll.get("name")}).then(function(t){l.voters=t.voters,e.scheduleRerender()})},html:function(t,e){var l=t.poll,o=l.get("options").reduce(function(t,e){return t+parseInt(e.html,10)*parseInt(e.votes,10)},0),n=l.get("voters"),i=0===n?0:(0,p.default)(o/n,-2),r=y.default.t("poll.average_rating",{average:i}),s=[(0,c.h)("div.poll-results-number-rating",new O.default({html:"<span>".concat(r,"</span>")}))];return l.get("public")&&(e.loaded||(e.voters=l.get("preloaded_voters"),e.loaded=!0),s.push(this.attach("discourse-poll-voters",{totalVotes:l.get("voters"),voters:e.voters||[],postId:t.post.id,pollName:l.get("name"),pollType:l.get("type")}))),s}}),(0,e.createWidget)("discourse-poll-container",{tagName:"div.poll-container",html:function(e){var l=this,t=e.poll,o=t.get("options");if(e.showResults){var n=[];e.titleHTML&&n.push(new O.default({html:e.titleHTML}));var i="number"===t.get("type")?"number":"standard",r="number"==i||e.poll.chart_type!==a.PIE_CHART_TYPE?"discourse-poll-".concat(i,"-results"):"discourse-poll-pie-chart";return n.push(this.attach(r,e)),n}if(o){var s=[];return e.titleHTML&&s.push(new O.default({html:e.titleHTML})),g(this.currentUser,t)||s.push((0,c.h)("div.alert.alert-danger",y.default.t("poll.results.groups.title",{groups:t.groups}))),s.push((0,c.h)("ul",o.map(function(t){return l.attach("discourse-poll-option",{option:t,isMultiple:e.isMultiple,vote:e.vote})}))),s}}}),(0,e.createWidget)("discourse-poll-info",{tagName:"div.poll-info",multipleHelpText:function(t,e,l){if(0<e)if(t===e){if(1<t)return y.default.t("poll.multiple.help.x_options",{count:t})}else{if(1<t)return e<l?y.default.t("poll.multiple.help.between_min_and_max_options",{min:t,max:e}):y.default.t("poll.multiple.help.at_least_min_options",{count:t});if(e<=l)return y.default.t("poll.multiple.help.up_to_max_options",{count:e})}},html:function(t){var e=t.poll,l=e.get("voters"),o=[(0,c.h)("p",[(0,c.h)("span.info-number",l.toString()),(0,c.h)("span.info-label",y.default.t("poll.voters",{count:l}))])];if(t.isMultiple)if(t.showResults||t.isClosed){var n=e.get("options").reduce(function(t,e){return t+parseInt(e.votes,10)},0);o.push((0,c.h)("p",[(0,c.h)("span.info-number",n.toString()),(0,c.h)("span.info-label",y.default.t("poll.total_votes",{count:n}))]))}else{var i=this.multipleHelpText(t.min,t.max,e.get("options.length"));i&&o.push(x(i))}return t.isClosed||t.showResults||!e.public||"staff_only"===e.results||o.push(x(y.default.t("poll.public.title"))),o}}),(0,e.createWidget)("discourse-poll-pie-canvas",{tagName:"canvas.poll-results-canvas",init:function(o){(0,l.default)("/javascripts/Chart.min.js").then(function(){var t=function(t,o){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},l="aspectRatio"in e?e.aspectRatio:2.2,n=o.map(function(t){return e=t,(new DOMParser).parseFromString(e,"text/html").body.textContent||"";var e});return{type:a.PIE_CHART_TYPE,data:{datasets:[{data:t,backgroundColor:(0,i.getColors)(t.length)}],labels:n},options:{responsive:!0,aspectRatio:l,animation:{duration:0},legend:{display:!1},legendCallback:function(t){for(var e="",l=0;l<o.length;l++)e+='<div class="legend"><span class="swatch" style="background-color:\n            '.concat(t.data.datasets[0].backgroundColor[l],'"></span>').concat(o[l],"</div>");return e}}}}(o.poll.options.mapBy("votes"),o.poll.options.mapBy("html")),e=document.getElementById("poll-results-chart-".concat(o.id)),l=new Chart(e.getContext("2d"),t);document.getElementById("poll-results-legend-".concat(o.id)).innerHTML=l.generateLegend()})},buildAttributes:function(t){return{id:"poll-results-chart-".concat(t.id)}}}),(0,e.createWidget)("discourse-poll-pie-chart",{tagName:"div.poll-results-chart",html:function(t){var e,l,o=[];if(!t.showResults)return e=t.id,(l=document.querySelector("#poll-results-chart-".concat(e)))&&l.parentNode.removeChild(l),o;var n=this.attach("discourse-poll-pie-canvas",t);return o.push(n),o.push((0,c.h)("div#poll-results-legend-".concat(t.id,".pie-chart-legends"))),o}}),(0,e.createWidget)("discourse-poll-buttons",{tagName:"div.poll-buttons",html:function(t){var e=[],l=t.poll,o=t.post,n=o.get("topic.archived"),i=t.isClosed,r="staff_only"===l.results,s=this.currentUser&&this.currentUser.staff,a=this.currentUser&&this.currentUser.admin,u=this.currentUser&&o.user_id===this.currentUser.id,p=this.siteSettings.data_explorer_enabled,c=!r&&(i||n),d=this.siteSettings.poll_export_data_explorer_query_id;if(t.isMultiple&&!c){var f=!t.canCastVotes;e.push(this.attach("button",{className:"cast-votes ".concat(f?"btn-default":"btn-primary"),label:"poll.cast-votes.label",title:"poll.cast-votes.title",disabled:f,action:"castVotes"})),e.push(" ")}if(t.showResults||c?e.push(this.attach("button",{className:"btn-default toggle-results",label:"poll.hide-results.label",title:"poll.hide-results.title",icon:"far-eye-slash",disabled:c,action:"toggleResults"})):"on_vote"!==l.get("results")||t.hasVoted||u?"on_close"!==l.get("results")||i?"staff_only"!==l.results||s?e.push(this.attach("button",{className:"btn-default toggle-results",label:"poll.show-results.label",title:"poll.show-results.title",icon:"far-eye",disabled:0===l.get("voters"),action:"toggleResults"})):e.push(x(y.default.t("poll.results.staff.title"))):e.push(x(y.default.t("poll.results.closed.title"))):e.push(x(y.default.t("poll.results.vote.title"))),t.groupableUserFields.length&&0<l.voters){var h=this.attach("button",{className:"btn-default poll-show-breakdown",label:"poll.group-results.label",title:"poll.group-results.title",icon:"far-eye",action:"showBreakdown"});e.push(h)}if(a&&p&&0<l.voters&&d&&e.push(this.attach("button",{className:"btn btn-default export-results",label:"poll.export-results.label",title:"poll.export-results.title",icon:"download",disabled:0===l.voters,action:"exportResults"})),l.get("close")){var m=moment(l.get("close"));if(m.isValid()){var b,g=m.format("LLL");if(t.isAutomaticallyClosed){var v=(0,w.relativeAge)(m.toDate(),{addAgo:!0});b=y.default.t("poll.automatic_close.age",{age:v})}else{var _=moment().to(m,!0);b=y.default.t("poll.automatic_close.closes_in",{timeLeft:_})}e.push(new O.default({html:'<span class="info-text" title="'.concat(g,'">').concat(b,"</span>")}))}}return!this.currentUser||this.currentUser.get("id")!==o.get("user_id")&&!s||n||(i?t.isAutomaticallyClosed||e.push(this.attach("button",{className:"btn-default toggle-status",label:"poll.open.label",title:"poll.open.title",icon:"unlock-alt",action:"toggleStatus"})):e.push(this.attach("button",{className:"toggle-status btn-danger",label:"poll.close.label",title:"poll.close.title",icon:"lock",action:"toggleStatus"}))),e}});var v=(0,e.createWidget)("discourse-poll",{tagName:"div",buildKey:function(t){return"poll-".concat(t.id)},buildAttributes:function(t){var e="poll";return t.poll.chart_type===a.PIE_CHART_TYPE&&(e+=" pie"),{class:e,"data-poll-name":t.poll.get("name"),"data-poll-type":t.poll.get("type")}},defaultState:function(t){var e=t.post,l=t.poll,o="staff_only"===t.poll.results;return{loading:!1,showResults:e.get("topic.archived")&&!o||this.isClosed()&&!o||"on_close"!==l.results&&this.hasVoted()&&!o}},html:function(t,e){var l="staff_only"===t.poll.results,o=e.showResults||t.post.get("topic.archived")&&!l||this.isClosed()&&!l,n=jQuery.extend({},t,{canCastVotes:this.canCastVotes(),hasVoted:this.hasVoted(),isAutomaticallyClosed:this.isAutomaticallyClosed(),isClosed:this.isClosed(),isMultiple:this.isMultiple(),max:this.max(),min:this.min(),showResults:o});return(0,c.h)("div",[this.attach("discourse-poll-container",n),this.attach("discourse-poll-info",n),this.attach("discourse-poll-buttons",n)])},min:function(){var t=parseInt(this.attrs.poll.get("min"),10);return(isNaN(t)||t<0)&&(t=0),t},max:function(){var t=parseInt(this.attrs.poll.get("max"),10),e=this.attrs.poll.get("options.length");return(isNaN(t)||e<t)&&(t=e),t},isAutomaticallyClosed:function(){var t=this.attrs.poll;return t.get("close")&&moment.utc(t.get("close"))<=moment()},isClosed:function(){return"closed"===this.attrs.poll.get("status")||this.isAutomaticallyClosed()},isMultiple:function(){return"multiple"===this.attrs.poll.get("type")},hasVoted:function(){var t=this.attrs.vote;return t&&0<t.length},canCastVotes:function(){var t=this.state,e=this.attrs;if(this.isClosed()||t.showResults||t.loading)return!1;var l=e.vote.length;return this.isMultiple()?l>=this.min()&&l<=this.max():0<l},toggleStatus:function(){var l=this,o=this.state,t=this.attrs,n=t.post,i=t.poll;this.isAutomaticallyClosed()||bootbox.confirm(y.default.t(this.isClosed()?"poll.open.confirm":"poll.close.confirm"),y.default.t("no_value"),y.default.t("yes_value"),function(t){if(t){o.loading=!0;var e=l.isClosed()?"open":"closed";(0,r.ajax)("/polls/toggle_status",{type:"PUT",data:{post_id:n.get("id"),poll_name:i.get("name"),status:e}}).then(function(){i.set("status",e),"on_close"===i.get("results")&&(o.showResults="closed"==e),l.scheduleRerender()}).catch(function(t){t?(0,u.popupAjaxError)(t):bootbox.alert(y.default.t("poll.error_while_toggling_status"))}).finally(function(){o.loading=!1})}})},toggleResults:function(){this.state.showResults=!this.state.showResults},exportResults:function(){var o=this.attrs,t=this.siteSettings.poll_export_data_explorer_query_id;(0,r.ajax)("/admin/plugins/explorer/queries/".concat(t,"/run.csv"),{type:"POST",data:{params:JSON.stringify({poll_name:o.poll.name,post_id:o.post.id.toString()}),explain:!1,limit:1e6,download:1}}).then(function(t){var e=document.createElement("a"),l=new Blob([t],{type:"text/csv;charset=utf-8;"});e.href=URL.createObjectURL(l),e.setAttribute("download","poll-export-".concat(o.poll.name,"-").concat(o.post.id,".csv")),e.click(),e.remove()}).catch(function(t){t?(0,u.popupAjaxError)(t):bootbox.alert(y.default.t("poll.error_while_exporting_results"))})},showLogin:function(){this.register.lookup("route:application").send("showLogin")},_toggleOption:function(t){var e=this.attrs.vote,l=e.indexOf(t.id);-1!==l?e.splice(l,1):e.push(t.id)},toggleOption:function(t){var e=this,l=this.attrs;if(!this.isClosed()){if(!this.currentUser)return this.showLogin();if(g(this.currentUser,this.attrs.poll)){var o=l.vote;return this.isMultiple()||(o.length=0),this._toggleOption(t),this.isMultiple()?void 0:this.castVotes().catch(function(){return e._toggleOption(t)})}}},castVotes:function(){var l=this;if(this.canCastVotes()){if(!this.currentUser)return this.showLogin();var o=this.attrs,n=this.state;return n.loading=!0,(0,r.ajax)("/polls/vote",{type:"PUT",data:{post_id:o.post.id,poll_name:o.poll.get("name"),options:o.vote}}).then(function(t){var e=t.poll;o.poll.setProperties(e),l.appEvents.trigger("poll:voted",e,o.post,o.vote),"on_close"!==o.poll.get("results")&&(n.showResults=!0),"staff_only"===o.poll.results&&(l.currentUser&&l.currentUser.get("staff")?n.showResults=!0:n.showResults=!1)}).catch(function(t){t?(0,u.popupAjaxError)(t):bootbox.alert(y.default.t("poll.error_while_casting_votes"))}).finally(function(){n.loading=!1})}},showBreakdown:function(){(0,d.default)("poll-breakdown",{model:this.attrs,panels:[{id:"percentage",title:"poll.breakdown.percentage"},{id:"count",title:"poll.breakdown.count"}]})}});t.default=v}),define("discourse/plugins/poll/initializers/extend-for-poll",["exports","@ember/object","discourse/widgets/glue","discourse-common/lib/get-owner","discourse-common/utils/decorators","discourse/lib/plugin-api"],function(t,g,v,p,c,e){"use strict";function l(h){var t,e,m=(0,p.getRegister)(h);h.modifyClass("controller:topic",{subscribe:function(){var l=this;this._super.apply(this,arguments),this.messageBus.subscribe("/polls/"+this.get("model.id"),function(t){var e=l.get("model.postStream").findLoadedPost(t.post_id);e&&e.set("polls",t.polls)})},unsubscribe:function(){this.messageBus.unsubscribe("/polls/*"),this._super.apply(this,arguments)}});var l,o,n,i,r,s,b=[],a=null;function u(){b.forEach(function(t){return t.queueRerender()})}h.modifyClass("model:post",(t=(0,c.observes)("polls"),l=e={_polls:null,pollsObject:null,pollsChanged:function(){var e=this,t=this.polls;t&&(this._polls=this._polls||{},t.forEach(function(t){e._polls[t.name]?e._polls[t.name].setProperties(t):e._polls[t.name]=g.default.create(t)}),this.set("pollsObject",this._polls),u())}},o="pollsChanged",n=[t],i=Object.getOwnPropertyDescriptor(e,"pollsChanged"),r=e,s={},Object.keys(i).forEach(function(t){s[t]=i[t]}),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=n.slice().reverse().reduce(function(t,e){return e(l,o,t)||t},s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(l,o,s),s=null),e)),h.includePostAttributes("polls","polls_votes"),h.decorateCooked(function(t,e){var l=$(".poll",t);if(l.length&&e){var c=e.getModel();h.preventCloak(c.id),c.pollsChanged();var d=c.pollsObject||{},f=c.polls_votes||{};a=a||setInterval(u,3e4),l.each(function(t,e){var l=$(e),o=l.data("poll-name"),n=d[o],i=c,r=f[o]||[],s=l.parent(".expanded-quote").data("post-id");if(s&&c.quoted[s]&&(i=c.quoted[s],i=g.default.create(i),n=g.default.create(i.polls.find(function(t){return t.name===o})),r=(r=i.polls_votes||{})[o]||[]),n){var a=e.querySelector(".poll-title"),u={id:"".concat(o,"-").concat(i.id),post:i,poll:n,vote:r,titleHTML:a&&a.outerHTML,groupableUserFields:(h.container.lookup("site-settings:main").poll_groupable_user_fields||"").split("|").filter(Boolean)},p=new v.default("discourse-poll",m,u);p.appendTo(e),b.push(p)}})}},{onlyStream:!0,id:"discourse-poll"}),h.cleanupStream(function(){a&&(clearInterval(a),a=null),b.forEach(function(t){return t.cleanUp()}),b=[]})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={name:"extend-for-poll",initialize:function(){(0,e.withPluginApi)("0.8.7",l)}};t.default=o}),define("discourse/plugins/poll/initializers/add-poll-ui-builder",["exports","discourse-common/utils/decorators","discourse/lib/show-modal","discourse/lib/plugin-api"],function(t,u,p,e){"use strict";function l(t){var e,l,o,n,i,r,s,a;t.modifyClass("controller:composer",(e=(0,u.default)("siteSettings.poll_enabled","siteSettings.poll_minimum_trust_level_to_create","model.topic.pm_with_non_human_user"),o=l={canBuildPoll:function(t,e,l){return t&&(l||this.currentUser&&(this.currentUser.staff||this.currentUser.trust_level>=e))},actions:{showPollBuilder:function(){(0,p.default)("poll-ui-builder").set("toolbarEvent",this.toolbarEvent)}}},n="canBuildPoll",i=[e],r=Object.getOwnPropertyDescriptor(l,"canBuildPoll"),s=l,a={},Object.keys(r).forEach(function(t){a[t]=r[t]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce(function(t,e){return e(o,n,t)||t},a),s&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(s):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(o,n,a),a=null),l)),t.addToolbarPopupMenuOptionsCallback(function(){return{action:"showPollBuilder",icon:"chart-bar",label:"poll.ui_builder.title",condition:"canBuildPoll"}})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={name:"add-poll-ui-builder",initialize:function(){(0,e.withPluginApi)("0.8.7",l)}};t.default=o});
//# sourceMappingURL=/assets/plugins/poll-a0e511fa005477e213b59a0836c0aa5276f4620dc2f97a62fd752924af137dc9.js.mapn#      b/b/DLdD       O^partitionKey=%28https%2Cdebian-fr.org%29,:https://www.debian-fr.org/assets/plugins/poll-a0e511fa005477e213b59a0836c0aa5276f4620dc2f97a62fd752924af137dc9.js necko:classified 1 strongly-framed 1 security-info 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 request-method GET request-Accept-Encoding gzip, deflate, br response-head HTTP/2 200 OK
server: nginx
date: Mon, 14 Mar 2022 09:53:29 GMT
content-type: application/javascript
content-length: 59861
last-modified: Thu, 08 Jul 2021 17:05:22 GMT
vary: Accept-Encoding
expires: Tue, 14 Mar 2023 09:53:29 GMT
cache-control: max-age=31536000, public,immutable
accept-ranges: bytes
X-Firefox-Spdy: h2
 original-response-headers server: nginx
date: Mon, 14 Mar 2022 09:53:29 GMT
content-type: application/javascript
content-length: 59861
last-modified: Thu, 08 Jul 2021 17:05:22 GMT
vary: Accept-Encoding
expires: Tue, 14 Mar 2023 09:53:29 GMT
cache-control: max-age=31536000
cache-control: public,immutable
accept-ranges: bytes
X-Firefox-Spdy: h2
 ctid 2 uncompressed-len 0 net-response-time-onstart 1884 net-response-time-onstop 1926   